
name: Manual Run

on:
    workflow_dispatch:
    push:
        tags:
            - '*'  
        paths:
            - "projects.md"
        
env:
    mlx_grph_DIR: mlx_grph

jobs:
    featurize_news:
        name: OpenSearch news > featurize > pipeline
        runs-on: ubuntu-latest
        steps:
        - name: Check-out mlx_grph repository
        uses: actions/checkout@v2
        with:
            repository: dcolinmorgan/mlx_grph
            token: ${{ secrets.GITHUB_TOKEN }}
            path: ${{ env.mlx_grph_DIR }}
        - name: Set up NodeJS
        uses: actions/setup-node@v2
        with:
            node-version: "14"
        - name: Install test dependencies
        run: |
            python -m pip install --upgrade pip
            python -m pip install -e .
        - name: Install dependencies
        run: npm ci
        - name: Find Weather Features
        run: python ${{ env.mlx_grph_DIR }}/DT_feat.py
        shell: sh
        - name: Run main script
        env:
            GH_TOKEN: ${{ secrets.GH_TOKEN }}
        run: npm start || exit 0
